.PHONY: build start serve stop down load_demo_data

# ----------- DEMO -----------
build:
	${INFO} "Creating demo image..."
	@ docker compose -f docker-compose.demo.yml build --no-cache web
	${INFO} "Build completed"

start:
	${INFO} "Running demo services (foreground)"
	@ docker compose -f docker-compose.demo.yml up

serve:
	${INFO} "Running demo services (detached)"
	@ docker compose -f docker-compose.demo.yml up -d

stop:
	${INFO} "Stopping demo services"
	@ docker compose -f docker-compose.demo.yml stop

down:
	${INFO} "Stopping demo services and deleting DB"
	@ docker compose -f docker-compose.demo.yml down -v

load_demo_data:
	${INFO} "Loading demo data"
	@ docker compose -f docker-compose.demo.yml exec web python manage.py loaddata aula/apps/*/fixtures/dades.json
	@ docker compose -f docker-compose.demo.yml exec web python manage.py loaddemodata

# ----------- Aesthetics -----------
YELLOW := "\e[1;33m"
NC := "\e[0m"

INFO := @bash -c '\
  printf $(YELLOW); \
  echo "=> $$1"; \
  printf $(NC)' SOME_VALUE
